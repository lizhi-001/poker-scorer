<view class="container">
  <view class="top-actions">
    <van-button type="primary" block bind:click="onCreateRoom">创建新牌局</van-button>
    <view class="join-row">
      <van-button type="info" class="join-btn" bind:click="onShowJoinDialog">输入房间号</van-button>
      <van-button type="info" class="join-btn" icon="scan" bind:click="onScanJoin">扫码加入</van-button>
    </view>
  </view>
  <view class="room-list" wx:if="{{rooms.length}}">
    <van-cell-group title="进行中的牌局">
      <van-cell
        wx:for="{{rooms}}" wx:key="_id"
        title="{{item.name}}"
        label="{{item.playerIds.length}}人 · 盲注 {{item.smallBlind}}/{{item.bigBlind}}"
        is-link bind:click="onEnterRoom" data-id="{{item._id}}"
      >
        <van-tag slot="right-icon" type="{{item.status === 'waiting' ? 'warning' : 'success'}}">
          {{item.status === 'waiting' ? '等待中' : '进行中'}}
        </van-tag>
      </van-cell>
    </van-cell-group>
  </view>
  <van-empty wx:else description="还没有牌局，创建一个吧" />
  <van-dialog
    use-slot
    show="{{showJoinDialog}}"
    title="加入牌局"
    show-cancel-button
    confirm-button-text="加入"
    bind:confirm="onConfirmJoin"
    bind:close="onCloseJoinDialog"
    confirm-button-loading="{{joinLoading}}"
  >
    <van-field
      value="{{joinCode}}"
      placeholder="请输入6位房间号"
      type="number"
      maxlength="6"
      bind:input="onJoinCodeInput"
      style="margin: 32rpx 0;"
    />
  </van-dialog>
</view>
